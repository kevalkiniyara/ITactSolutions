(function(){function t(n,t,i){var r="";return r+="<button class='btn btn-xs btn-success btnEdit' data-id='"+i.id+" 'tooltip='Edit'><i class='fa fa-edit'><\/i><\/button>&nbsp; ",r+="<button class='btn btn-xs btn-danger btnDelete' data-id='"+i.id+"'tooltip='Delete'><i class='fa fa-remove'><\/i><\/button>&nbsp;",r+("<button class='btn btn-xs btn-danger btnGraph' data-id='"+i.id+"'tooltip='Get'><i class='fa fa-bars'><\/i><\/button>")}function i(n){return n!==null&&n!==""?moment(n).format("L"):""}function n(n){if(n!==null&&n!=="")return n.toFixed(2)}$(function(){function e(){$("#dialog").dialog({autoOpen:!1,width:600,height:500,modal:!0});abp.ajax({url:"/Orders/GetOrderData",type:"get",contentType:!1,processData:!1}).done(function(n){for(var i=[],r=[],t=0;t<n.length;t++)i.push(n[t].item),r.push(n[t].orderNumber);Highcharts.chart("container",{chart:{type:"line"},title:{text:"Order-Items"},subtitle:{text:"Line-Graph"},xAxis:{categories:r},yAxis:{title:{text:"Quantity"}},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},series:[{name:"Items",data:i}]})});$("#dialog").dialog("open")}function o(n){window.location.href=n>0?"/Orders/CreateOrUpdateOrder?id="+n:"/Students/CreateOrUpdateOrder"}function s(n){abp.message.confirm(abp.utils.formatString(abp.localization.localize("Deleteorder","ITactDemo")),function(t){t&&f.deleteorder({id:n}).done(function(){abp.notify.success(app.localize("SuccessfullyDeleted"));jQuery(r).trigger("reloadGrid")})})}var f=abp.services.app.order;$("#CreateOrder").click(function(){window.location.href="/Orders/CreateOrUpdateOrder"});var r="#order",u="#orderPager";jQuery(r).jqGrid({url:"/Orders/GetOrder",sortname:"id",colNames:["Order Number","Order Date","Description","Total Amount","Id","Action"],colModel:[{name:"orderNumber",index:"orderNumber",search:!0,width:20},{name:"orderDate",index:"orderDate",search:!0,width:20,formatter:i,searchoptions:{sopt:["eq"],dataInit:function(n){$(n).datepicker({singleDatePicker:!0,autoclose:!0,showDropdowns:!0,autoUpdateInput:!1}).on("apply.datepicker",function(n,t){$(this).val(t.startDate.format("L"));$(this).keydown()})}}},{name:"description",index:"description",search:!0,width:100},{name:"totalAmount",index:"totalAmount",search:!0,width:20,formatter:n,align:"right"},{name:"id",index:"id",hidden:!0,key:!0},{name:"actions",index:"id",formatter:t,sortable:!1,width:150,align:"center",search:!1,width:20}],pager:u,height:"100%",width:"auto",viewrecords:!0,multiselect:!1,subGrid:!0,subGridOptions:{plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:" ui-icon-arrowreturn-1-s"},subGridRowExpanded:function(t,i){var r,u;r=t+"_t";u="p_"+r;$("#"+t).html("<table id='"+r+"'><\/table><div id='"+u+"'><\/div>");jQuery("#"+r).jqGrid({url:"/Orders/GetOrderItems?id="+i,colNames:["Item Name","Price"],colModel:[{name:"itemName",index:"itemName",width:50},{name:"price",index:"price",width:50,align:"right",formatter:n}],rowNum:10,pager:u,height:"100%",width:"100%",loadComplete:function(){jQuery("#"+r).trigger("resize");$("#"+r).jqGrid("setGridWidth",$("#"+r).closest(".jqgrid").width())}});jQuery("#"+r).navGrid(u,jgridNavOpt)},loadComplete:function(){jQuery(r).trigger("resize");$(r).jqGrid("setGridWidth",$(r).closest(".jqgrid").width());$(r+" .btnDelete").click(function(){s($(this).data().id)});$(r+" .btnGraph").click(function(){e()});$(r+" .btnEdit").click(function(){o($(this).data().id)})}});jQuery(r).navGrid(u,jgridNavOpt);jQuery(r).jqGrid("filterToolbar",jgridFilterOpt,{search:!0,searchtext:"Search"})})})();