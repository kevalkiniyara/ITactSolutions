(function(){var t=abp.services.app.order,n=$(".dynamic-items"),i=$("#itemTemplate","#template"),r=$("#Item");$(document).on("click",".add-item",function(){var t=null;t=i.clone().appendTo(n);t.find("[name=Price]").val();$(".item",n).each(function(n){$(this).find("td:first-child").html(n+1)})});$("#orderdatepicker").datepicker({format:"mm/dd/yyyy",autoclose:!0,endDate:new Date});$(document).on("change","#Category",function(){$("#ordertable").loading("start");$("#ordertable").loading("stop");var n=$(this),i=n.val();t.itemCombobox(i).done(function(t){if(t!=null){var i=n.closest("tr").find(".items");i.find("option").remove();i.append("<option value=''>Select<\/option>");$.each(t,function(n,t){i.append($("<option/>",{value:t.value,text:t.displayText,selected:t.isSelected?!0:!1}))})}});$(document).on("change","#ItemId",function(){var n=$(this),i=n.val();t.getItemPrice(i).done(function(t){if(t!=null){var r=n.closest("tr").find(".price"),i=numeral(t);numeral.defaultFormat("0,0.00");i.format();r.val(i.value().toFixed(2))}})});$(document).on("change","#ItemId",function(){var n=$(this),i=n.val();t.getItemImage(i).done(function(t){if(t!=null){var i=n.closest("tr").find(".image");i.attr("src","/"+t);i.attr("height",100);i.attr("width",100);i.val(t)}})})});$(document).on("click","#btnCancel",function(){window.location.href="/Orders"});$(document).on("click","#btnSave",function(i){var u,r,f;($.trim($("#ItemId").val())==""&&alert("please Select Item"),u=$("[name=OrderForm]"),u.valid())&&(i.preventDefault(),$("#orderData").hide(),$("#imgloading").show(),r=u.serializeFormToObject(),f=0,$("[name=Price]",n).each(function(){var n=$(this).val();f+=parseFloat(n)}),r.TotalAmount=f,r.OrderItems=[],$(".dynamic-items .item").each(function(){var n={};n.Id=$(this).find("[name=Id]").val();n.ItemId=$(this).find("[name=ItemId]").val();n.price=$(this).find("[name=Price]").val();r.OrderItems.push(n)}),r.OrderItems.length>0&&t.createOrupdateOrder(r).done(function(){$("#imgloading").hide();abp.notify.success("Saved Sucessfully","Success");window.location.href="/Orders"}))});$(n).on("click",".item .remove-item",function(){$(this).closest("tr").remove();$(".item",n).each(function(n){$(this).find("td:first-child").html(n+1)})});$(document).on("click","#btnSaveSP",function(i){var f=$("[name=OrderForm]"),r,u;f.valid()&&(i.preventDefault(),r=f.serializeFormToObject(),u=0,$("[name=Price]",n).each(function(){var n=$(this).val();u+=parseFloat(n)}),r.TotalAmount=u,r.OrderItems=[],$(".dynamic-items .item").each(function(){var n={};n.Id=$(this).find("[name=Id]").val();n.ItemId=$(this).find("[name=ItemId]").val();n.price=$(this).find("[name=Price]").val();r.OrderItems.push(n)}),r.OrderItems.length>0&&t.createJsonOrder(r).done(function(){abp.notify.success("Saved Sucessfully","Success");window.location.href="/Orders"}))})})();